#:import Settings kivy.uix.settings
#:import SimulationCursor ui.cursor
#:import SimulationGrid ui.widgets
#import Factory kivy.factory.Factory
#:include kv/widgets.kv
FloatLayout:
    SimulationGrid:
        id: simulation_grid
        size_hint: .9, .9
        pos_hint: {'x': 0, 'top': 1}
        cursor: simulation_cursor
        on_touch_down: simulation_cursor.on_grid_touch_down(self, args[1])
        on_touch_move: simulation_cursor.on_grid_touch_move(self, args[1])

    SimulationCursor:
        id: simulation_cursor
        size_hint: None, None
        size: 10, 10
        pos: 0, 0
        shape: 'ellipse'
        cursor_width: 10
        cursor_height: 10

    Label:
        id: fps_label
        size_hint: None, None
        pos_hint: {'top': 1, 'x': 0.1}
        text: str(app.fps)
        font_size: 22

    Label:
        id: hud_label
        size_hint: None, None
        size: 200, 100
        pos_hint: {'top': 1, 'right': .85}
        text: ""
        font_size: 22
        color: 1, 1, 1, 1
        canvas.before:
            Color:
                rgba: 0, 0, 0, 0.7
            Rectangle:
                pos: self.pos
                size: self.size

    Toolbar:
        id: toolbar

    BoxLayout:
        orientation: "vertical"
        size_hint: .1, .9
        pos_hint: {'right': 1, 'top': 1}

    RelativeLayout:
        id: scene_graph
        size_hint: .9, .9
        pos_hint: {'x': 0, 'top': 1}
        canvas.after:
            Color:
                rgba: 0.8, 0.8, 0.8, 1
            Line:
                rectangle: self.x, self.y, self.width, root.height
                width: 1

#<BackgroundColor@Widget>
#   background_color: [0, 0, 0, 1]

<DraggableTableHead>:
    font_size: 26
    bold: True
    color: 1, 1, 1, 1
    size_hint: None, None
    height: 60
    text_size: None, None
    halign: 'center'
    valign: 'middle'
    canvas.before:
        Color:
            rgba: 0.5, 0.5, 0.5, 1
        Rectangle:
            pos: self.pos
            size: self.size
    canvas.after:
        Color:
            rgba: 0, 0, 0, 1
        Line:
            rectangle: self.x, self.y, self.width, self.height
            width: 1

<PickerLabel>:
    background_color: [0.9, 0.9, 0.9, 1]
    font_size: 30
    size_hint: None, None
    color: 0, 0, 0, 1
    bold: False
    height: 40
    text_size: None, None
    halign: 'center'
    valign: 'middle'
    canvas.before:
        Color:
            rgba: self.background_color
        Rectangle:
            size: self.size
            pos: self.pos
    canvas.after:
        Color:
            rgba: 0, 0, 0, 1
        Line:
            rectangle: self.x, self.y, self.width, self.height
            width: 1
  #  on_touch_down: root.on_color_touch(args[1]) if not self.text else None

<PickerModal>:
    id: picker_modal
    size_hint: .9, .9
    pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    auto_dismiss: True
    background: ''
    background_color: 0, 0, 0, 0
    overlay_color: 0, 0, 0, 0.5
    canvas.before:
        Color:
            rgba: 0.2, 0.2, 0.2, 1  # Custom background color
        Rectangle:
            pos: self.pos
            size: self.size
    TabbedPanel:
        do_default_tab: False
        TabbedPanelItem:
            id: picker_modal_panel
            text: "Elements"
        TabbedPanelItem:
            text: "Settings"
            content: app.settings
            #    orientation: "vertical"
            #    size_hint: 1, 1
            #    Label:
            #        text: "Settings go here"
            #        size_hint: 1, 0.9
            #    Button:
            #        text: "Close"
            #        size_hint: 1, 0.1
            #        on_release: picker_modal.dismiss()
